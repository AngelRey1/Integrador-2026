<div class="header-container">
  <div class="logo-container">
    <a (click)="toggleSidebar()" href="#" class="sidebar-toggle">
      <nb-icon icon="menu-2-outline"></nb-icon>
    </a>
    <a class="logo" href="#" (click)="navigateHome()">Sport<span>Connect</span></a>
  </div>
  <nb-select [selected]="currentTheme" (selectedChange)="changeTheme($event)" status="primary">
    <nb-option *ngFor="let theme of themes" [value]="theme.value"> {{ theme.name }}</nb-option>
  </nb-select>
</div>

<div class="header-container">
  <nb-actions size="small">

    <nb-action class="control-item">
      <nb-search type="rotate-layout"></nb-search>
    </nb-action>

    <!-- Notificaciones con badge -->
    <nb-action class="control-item notification-action" (click)="toggleNotificaciones()">
      <nb-icon icon="bell-outline"></nb-icon>
      <span *ngIf="notificacionesNoLeidas > 0" class="notification-badge">
        {{ notificacionesNoLeidas > 9 ? '9+' : notificacionesNoLeidas }}
      </span>
    </nb-action>

    <!-- Dropdown de notificaciones -->
    <div class="notifications-dropdown" *ngIf="mostrarNotificaciones" (clickOutside)="cerrarNotificaciones()">
      <div class="notifications-header">
        <h6>Notificaciones</h6>
        <a *ngIf="notificacionesNoLeidas > 0" (click)="marcarTodasComoLeidas()" class="mark-all-read">
          Marcar todas como le√≠das
        </a>
      </div>
      <div class="notifications-list" *ngIf="notificaciones.length > 0">
        <div *ngFor="let notif of notificaciones" class="notification-item" [class.unread]="!notif.leida"
          (click)="marcarComoLeida(notif)">
          <div class="notification-icon">
            <nb-icon [icon]="getIconoNotificacion(notif.tipo)"></nb-icon>
          </div>
          <div class="notification-content">
            <div class="notification-title">{{ notif.titulo }}</div>
            <div class="notification-message">{{ notif.mensaje }}</div>
            <div class="notification-time">{{ formatearFecha(notif.fecha) }}</div>
          </div>
        </div>
      </div>
      <div class="notifications-empty" *ngIf="notificaciones.length === 0">
        <nb-icon icon="bell-off-outline"></nb-icon>
        <p>No tienes notificaciones</p>
      </div>
    </div>

    <nb-action class="user-action" *nbIsGranted="['view', 'user']">
      <nb-user [nbContextMenu]="userMenu" [nbContextMenuTag]="'user-context-menu'" [onlyPicture]="userPictureOnly"
        [name]="user?.name" [picture]="user?.picture">
      </nb-user>
    </nb-action>
  </nb-actions>
</div>